<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>blanks</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="data/vocaBlanks.js" defer></script>
</head>
<body>

<h1>VocabFlash</h1>
<h2 id="inputCounter">Word: 1 / 10</h2>  <!-- Zähler für die Eingabemethode -->
<!-- Set Auswahl -->
<label for="setSelect">Choose a set:</label>
<select id="setSelect" onchange="updateVocabSet()">
    <option value="set1">Set 1</option>
    <option value="set2">Set 2</option>
    <!-- Weitere Sets hinzufügen -->
</select>
<button onclick="updateVocabSet()">Bestätigen</button>

<!-- Bereich für die Vokabelabfrage -->
<div id="vocabArea">
    <h3 id="vocabWord"></h3>
    <input type="text" id="userInput" placeholder="Fill in the blank" 
           oninput="toggleCheckButton()" 
           onkeydown="handleKeyDown(event)">
    <button id="submitAnswer" onclick="checkAnswer()" style="display: none;">Check</button>
    <button id="skipButton" onclick="skipToNext()" style="display: none;">Skip</button> <!-- Skip-Button, standardmäßig unsichtbar -->
</div>

<!-- Feedback-Element -->
<p id="feedback"></p> <!-- Feedback-Element hinzufügen -->

    
<!--SKRIPT-->
<script>
let currentSet = [];
let currentIndex = 0;
let wrongAttempts = 0; // Variable für falsche Versuche
let wrongAnswers = []; // Liste für falsche Antworten
let timer; // Variable für den Timer
    
// Funktion, um die Vokabeln aus dem ausgewählten Set anzuzeigen
function displayVocabWord() {
    const vocabWord = document.getElementById('vocabWord');
    const inputCounter = document.getElementById('inputCounter'); // Zähler-Element
    const submitButton = document.getElementById('submitAnswer'); // Check-Button
    
    if (currentSet.length > 0) {
        const vocab = currentSet[currentIndex];
        vocabWord.innerText = vocab.de; // Zeige das deutsche Wort an
        vocabWord.classList.remove('correct', 'wrong', 'solution'); // Entferne Farben

        // Aktualisiere den Zähler
        inputCounter.innerText = `Wort: ${currentIndex + 1} / ${currentSet.length}`;


    // Check-Button anzeigen, da eine neue Frage gestellt wird
    submitButton.style.display = "none";

    }
}


// Funktion, um das ausgewählte Set zu aktualisieren
function updateVocabSet() {
    const selectedSet = document.getElementById('setSelect').value;

    // Überprüfe, ob das Set existiert
    if (vocabSets[selectedSet]) {
        currentSet = vocabSets[selectedSet]; // Das ausgewählte Set laden
        currentIndex = 0; // Startindex zurücksetzen
        displayVocabWord(); // Zeigt das erste Wort an
    } else {
        console.error("Set nicht gefunden: ", selectedSet);
    }
}

// Funktion für den Skip-Button
function skipToNext() {
    clearTimeout(timer); // Timer zurücksetzen
    nextWord(); // Gehe zur nächsten Karte
}



// Funktion, um das Feedback-Element zu löschen
function clearFeedback() {
    const feedback = document.getElementById('feedback');
    feedback.innerText = ''; // Lösche den Text im Feedback-Element
}

// Funktion für den nächsten Wortwechsel
function nextWord() {
    clearTimeout(timer); // Timer zurücksetzen
    const skipButton = document.getElementById('skipButton');
    const submitButton = document.getElementById('submitAnswer');
    skipButton.style.display = "none"; // Blende den Skip-Button aus
    submitButton.style.display = "none"; // Blende den Check-Button aus

    clearFeedback(); // Lösche vorheriges Feedback
    currentIndex++; // Gehe zur nächsten Karte
    wrongAttempts = 0; // Zurücksetzen der falschen Versuche

    if (currentIndex < currentSet.length) {
        displayVocabWord(); // Zeigt das nächste Wort an
        submitButton.style.display = "block"; // Zeige den Check-Button
    } else {
        alert("Excercise completed!");
    }
}


// Funktion, um die Benutzerantwort zu überprüfen
function checkAnswer() {
 function checkAnswer() {
    const userInput = document.getElementById('userInput').value; // Eingabewert
    const currentWord = currentSet[currentIndex]; // Aktuelles Wort
    const feedback = document.getElementById('feedback'); // Feedback-Element
    const skipButton = document.getElementById('skipButton'); // Skip-Button
    const vocabWord = document.getElementById('vocabWord'); // Satz

    if (userInput.toLowerCase() === currentWord.ar.toLowerCase()) {
        // Richtige Antwort
        feedback.innerText = "Correct!";
        feedback.classList.remove('wrong', 'solution');
        feedback.classList.add('correct');
        vocabWord.classList.add('correct'); // Satz grün färben
        skipButton.style.display = "block"; // Zeige den Skip-Button
        startTimer(); // Starte den Timer

        wrongAttempts = 0;
    } else {
        // Falsche Antwort
        wrongAttempts++;
        
        if (wrongAttempts === 1) {
            feedback.innerText = "Try again.";
            feedback.classList.remove('correct', 'solution');
            feedback.classList.add('wrong');
            vocabWord.classList.add('wrong'); // Satz orange färben
            skipButton.style.display = "none"; // Blende den Skip-Button aus
        } else if (wrongAttempts === 2) {
            feedback.innerText = `The correct answer is: ${currentWord.ar}`;
            feedback.classList.remove('correct', 'wrong');
            feedback.classList.add('solution');
            vocabWord.classList.add('solution'); // Satz rot färben
            wrongAnswers.push(currentWord);
            skipButton.style.display = "block"; // Zeige den Skip-Button
            startTimer(); // Starte den Timer
        }
    }

    // Eingabefeld und Check-Button ausblenden
    document.getElementById('userInput').value = '';
    document.getElementById('submitAnswer').style.display = "block"; // Zeige den Check-Button wieder an
}


// Funktion, um den Timer zu starten
function startTimer() {
    timer = setTimeout(nextWord, 4000); // Wechselt nach 4 Sekunden automatisch zum nächsten Wort
}

// Funktion, um den Check-Button basierend auf der Eingabe sichtbar zu machen
function toggleCheckButton() {
    const userInput = document.getElementById('userInput').value;
    const submitButton = document.getElementById('submitAnswer');

    if (userInput.trim() !== "" && timer == null) {
        submitButton.style.display = "block"; // Zeige den Check-Button
    } else {
        submitButton.style.display = "none"; // Blende den Check-Button aus
    }
}

// Funktion zur Behandlung der Tastenereignisse
function handleKeyDown(event) {
    const skipButton = document.getElementById('skipButton');
    if (event.key === 'Enter') {
        const checkButton = document.getElementById('submitAnswer');
        if (checkButton.style.display !== 'none') {
            checkAnswer(); // Wenn der Check-Button sichtbar ist, führt Enter die Überprüfung aus
        } else if (skipButton.style.display !== 'none') {
            skipToNext(); // Wenn der Skip-Button sichtbar ist, führt Enter das Skippen aus
        }
    }
}

// Initiales Set anzeigen
window.onload = function() {
    updateVocabSet(); // Zeigt beim ersten Laden das Standardset an
};

</script>


<!-- Zurück Links -->
<br><a href="javascript:history.back()">Zurück</a><br>
<a href="index.html">Zurück zur Homepage</a>
<!--Ende HTML-->
</body>
</html>
