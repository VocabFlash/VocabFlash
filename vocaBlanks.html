<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VocabFlash</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="data/vocaBlanks.js" defer></script>
    <script src="css/java.js" defer></script>
</head>
<body>

<a href="index.html"><h1>VocabFlash</h1></a>
<h2 id="inputCounter">Word: 1 / 10</h2>

<div class="container">
    <div id="vocabArea">
        <h3 id="vocabWord"></h3>
        <input type="text" id="userInput" placeholder="Fill in the blank" 
               oninput="toggleCheckButton()" 
               onkeydown="handleKeyDown(event)">
        <div style="text-align: center;">
            <button id="submitAnswer" class="confirm-button" onclick="checkAnswer()" style="display: none;">Check</button>
            <button id="skipButton" class="confirm-button" onclick="skipToNext()" style="display: none;">Skip</button>
        </div> 
        <p id="feedback"></p>
    </div>
</div>

<div class="container">
    <label for="setSelect">Choose a set:</label>
    <select id="setSelect" onchange="updateVocabSet()">
        <option value="set1">Set 1</option>
        <option value="set2">Set 2</option>
    </select>
    <button class="confirm-button" onclick="updateVocabSet()">Confirm</button>
    <br><a href="result.html">Show results</a><br>
    <a href="javascript:history.back()">Go back</a><br>
    <a href="index.html">Go back to homepage</a>
</div>

<script>
let currentSet = [];
let currentIndex = 0;
let wrongAttempts = 0;
let wrongAnswers = [];
let secondRound = false;
let timer;
let results = [];

// Funktion zum Zufälligmischen des Arrays
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// Funktion, um die Vokabeln aus dem ausgewählten Set anzuzeigen
function displayVocabWord() {
    console.log("Aktuelles Set:", currentSet);
    
    if (!secondRound && currentIndex === 0) {
        shuffle(currentSet);
    }
    
    const vocabWord = document.getElementById('vocabWord');
    const inputCounter = document.getElementById('inputCounter');
    const submitButton = document.getElementById('submitAnswer');
    const skipButton = document.getElementById('skipButton');
    const feedback = document.getElementById('feedback');

    feedback.innerText = ''; // Feedback zurücksetzen

    if (currentSet.length > 0) {
        const vocab = currentSet[currentIndex];
        vocabWord.innerText = vocab.de;
        vocabWord.classList.remove('correct', 'wrong', 'solution');

        inputCounter.innerText = `Word: ${currentIndex + 1} / ${currentSet.length}`;
        submitButton.style.display = "block"; // Zeige den Check-Button
        skipButton.style.display = "none"; // Skip-Button zu Beginn ausblenden
    }
}

// Funktion, um das ausgewählte Set zu aktualisieren
function updateVocabSet() {
    const selectedSet = document.getElementById('setSelect').value;
    console.log("Ausgewähltes Set:", selectedSet); // Konsolenausgabe hinzufügen
    if (vocabSets[selectedSet]) {
        currentSet = vocabSets[selectedSet];
        currentIndex = 0;
        wrongAnswers = []; // Setze die falschen Antworten zurück
        secondRound = false; // Setze die zweite Runde zurück
        console.log("Aktuelles Set geladen:", currentSet); // Konsolenausgabe hinzufügen
        displayVocabWord();
    } else {
        console.error("Set nicht gefunden:", selectedSet); // Fehlerausgabe
    }
}

function checkAnswer() {
    const userInput = document.getElementById('userInput').value.trim();
    const currentVocab = currentSet[currentIndex].solution; // Assuming you have a solution property

    const feedback = document.getElementById('feedback');
    const submitButton = document.getElementById('submitAnswer');
    const skipButton = document.getElementById('skipButton');

    if (userInput.toLowerCase() === currentVocab.toLowerCase()) {
        feedback.innerText = "Correct!";
        feedback.className = "correct"; // Set correct class for styling
        // Here you can increment index or set up for next word
        currentIndex++;
        if (currentIndex < currentSet.length) {
            displayVocabWord(); // Load next vocab word
        } else {
            // Logic when all words are done (e.g., show results)
        }
    } else {
        feedback.innerText = "Try again!";
        feedback.className = "wrong"; // Set wrong class for styling
        // Add logic to handle wrong answers if needed
    }
}

// Initiales Set anzeigen
window.onload = function() {
    console.log("Seite geladen, setSelect wird aktualisiert."); // Konsolenausgabe hinzufügen
    updateVocabSet(); // Zeigt beim ersten Laden das Standardset an
};
</script>

</body>
</html>
