<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results</title>
    <link rel="stylesheet" href="css/resultstyle.css">
    <style>
        .table-container {
            margin-bottom: 20px; /* Abstand zwischen den Tabellen */
        }
        table {
            width: 100%; /* Tabelle nimmt die gesamte Breite ein */
            border-collapse: collapse; /* Tabellenränder zusammenführen */
        }
        th, td {
            border: 1px solid #ccc; /* Tabellenrahmen */
            padding: 8px; /* Innenabstand */
            text-align: left; /* Text links ausrichten */
        }
    </style>
</head>
<body>
<a href="index.html"><h1>VocabFlash</h1></a>
    
<div class="container">
    <h2>Results</h2>
</div>
    
<div class="table-container" id="tableContainer">
    <table id="vocabResultsTableRound1">
        <thead id="tableHeaderRound1"></thead>
        <tbody id="resultsContainerRound1"></tbody>
    </table>

    <table id="vocabResultsTableRound2" style="display: none;">
        <thead id="tableHeaderRound2"></thead>
        <tbody id="resultsContainerRound2"></tbody>
    </table>
</div>

<br>

<div class="container">
    <label for="resultDropdown">Choose the result type:</label>
    <select id="resultDropdown" aria-label="Choose the result type" onchange="updateResults()">
        <option value="practise">Practise Flashcards</option>
        <option value="verbForms">Verbs</option>
        <option value="vocaBlanks">Blanks</option>
        <option value="vocaInput">Spelling</option>
    </select>

    <br>
    <button onclick="updateResults()">Select</button>
    <br>
    <a href="index.html">Go back to Homepage</a>
</div>

<script>
function getFromLocalStorage(key) {
    const data = localStorage.getItem(key);
    if (!data) return [];
    try {
        return JSON.parse(data);
    } catch (e) {
        return [];
    }
}

const resultsContainerRound1 = document.getElementById('resultsContainerRound1');
const resultsContainerRound2 = document.getElementById('resultsContainerRound2');
const tableHeaderRound1 = document.getElementById('tableHeaderRound1');
const tableHeaderRound2 = document.getElementById('tableHeaderRound2');
const dropdown = document.getElementById('resultDropdown');

function loadResults() {
    resultsContainerRound1.innerHTML = ""; // Clear previous results
    resultsContainerRound2.innerHTML = "";

    const selectedType = dropdown.value;
    let loadedResults = getFromLocalStorage(selectedType + "Results");

    let headerHTML = `
        <tr>
            <th>Translation</th>
            <th>Word</th>
        </tr>
    `;

    tableHeaderRound1.innerHTML = headerHTML;
    tableHeaderRound2.innerHTML = headerHTML;

    if (loadedResults.length === 0) {
        resultsContainerRound1.innerHTML = "<tr><td colspan='2'>No results available.</td></tr>";
        return;
    }

    // Sort results for the first and second rounds
    const round1Results = loadedResults.filter(result => result.round === 1);
    const round2Results = loadedResults.filter(result => result.round === 2);

    // Populate round 1 results
    round1Results.forEach(result => {
        const resultRow = createResultRow(result.word, result.translation, result.status);
        resultsContainerRound1.appendChild(resultRow);
    });

    // Show round 1 table if there are results
    document.getElementById('vocabResultsTableRound1').style.display = round1Results.length > 0 ? 'table' : 'none';

    // Populate round 2 results
    round2Results.forEach(result => {
        const resultRow = createResultRow(result.word, result.translation, result.status);
        resultsContainerRound2.appendChild(resultRow);
    });

    // Show round 2 table if there are results
    document.getElementById('vocabResultsTableRound2').style.display = round2Results.length > 0 ? 'table' : 'none';
}

function createResultRow(word, translation, status) {
    const resultRow = document.createElement('tr');
    resultRow.classList.add(status); // Add class for status

    const wordCell = document.createElement('td');
    wordCell.innerText = word;
    resultRow.appendChild(wordCell);

    const translationCell = document.createElement('td');
    translationCell.innerText = translation;
    resultRow.appendChild(translationCell);

    return resultRow;
}

window.onload = loadResults;

function updateResults() {
    loadResults();
}
</script>
</body>
</html>
